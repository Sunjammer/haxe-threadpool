version: "{build}"

clone_folder: C:\projects\haxe-threadpool

environment:
    global:
        HAXE_ROOT: C:\projects\haxe
        HAXELIB_ROOT: C:\projects\haxelib

install:
    # Install haxe and neko
    - cinst neko -y
    - cinst haxe --prerelease --ignore-dependencies -s 'https://ci.appveyor.com/nuget/haxe' -y
    - RefreshEnv
    - neko -version
    - haxe -version
    # Setup haxelib
    - mkdir "%HAXELIB_ROOT%"
    - haxelib setup "%HAXELIB_ROOT%"
    - haxelib install record-macros
    - haxelib install hxcpp

build_script:
    - cd test
    - haxe compile.hxml

test_script:
    - echo CPP
    - pwd
    - bin/test/TestMain.exe
    - echo NEKO
    - neko bin/test/TestMain.n
